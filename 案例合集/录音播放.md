#audioplayers #path_provider #flutter_sound #permission_handler #provider 
项目地址[permission_handler_test: 各种权限的使用 (gitee.com)](https://gitee.com/fir-sheng/permission_handler_test)
这个案例利用`permission_handler`进行权限管理,用`provider`来进行状态管理,`path_provider`获取存储路径,`flutter_sound`来录音并保存和播放,`audioplayers`负责获取播放时长.
关于介绍,采用一点点添加功能去描述,有利于慢慢了解每个插件的使用
# 实现效果
实现效果为点击`Start Recording`后开始录音.再次点击结束录音,并添加到列表中,显示名称和时长.
点击`Start Playback`后开始播放.再次点击结束播放,或者播放结束自动停止.

![[录音播放实现效果1.1.png]]![[录音播放实现效果1.2.png]]
# 准备工作
项目开始前现根据插件进行准备工作
- permission_handler的配置
- flutter_sound的配置
在![[录音播放案例的准备工作1.1.png]]
下添加
```
    <uses-feature
        android:name="android.hardware.camera"
        android:required="false" />

    <uses-permission android:name="android.permission.CAMERA" />
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.RECORD_AUDIO"/>
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
```
添加后
![[录音播放的准备工作1.2.png]]
# 第一版录音和播放
首先创建了`RecordingProvider`类去使用`provider` 利于全局的状态管理
```
class RecordingProvider with ChangeNotifier {}
```
录音和播放采用的